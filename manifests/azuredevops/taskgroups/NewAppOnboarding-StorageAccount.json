{
	"category": "Deploy",
	"description": "Provision a Storage Account for an app",
	"friendlyName": "NewAppOnboarding - Provision Storage Account",
	"iconUrl": "https://cdn.vsassets.io/v/M147_20190226.3/_content/icon-meta-task.png",
	"inputs": [
		{
			"aliases": [],
			"options": {},
			"properties": {},
			"name": "appenvironment",
			"label": "appenvironment",
			"defaultValue": "",
			"required": true,
			"type": "string",
			"helpMarkDown": "",
			"groupName": ""
		},
		{
			"aliases": [],
			"options": {},
			"properties": {},
			"name": "appname",
			"label": "appname",
			"defaultValue": "",
			"required": true,
			"type": "string",
			"helpMarkDown": "",
			"groupName": ""
		},
		{
			"aliases": [],
			"options": {},
			"properties": {},
			"name": "Azure_DataResourceGroup",
			"label": "Azure_DataResourceGroup",
			"defaultValue": "",
			"required": true,
			"type": "string",
			"helpMarkDown": "Resource Group Name",
			"groupName": ""
		},
		{
			"aliases": [],
			"options": {},
			"properties": {},
			"name": "Azure_Subcription",
			"label": "Azure_Subcription",
			"defaultValue": "",
			"required": true,
			"type": "connectedService:AzureRM",
			"helpMarkDown": "Azure Resource Manager subscription where storage is.",
			"groupName": ""
		}
	],
	"instanceNameFormat": "Task group: NewAppOnboarding - Provision Storage Account - Copy $(appenvironment)",
	"name": "NewAppOnboarding - Provision Storage Account - Copy",
	"parentDefinitionId": null,
	"runsOn": [
		"Agent",
		"DeploymentGroup"
	],
	"tasks": [
		{
			"alwaysRun": false,
			"condition": "succeeded()",
			"continueOnError": false,
			"displayName": "Create Storage Account",
			"enabled": true,
			"inputs": {
				"ConnectedServiceName": "$(Azure_Subcription)",
				"ResourceGroupName": "$(Azure_DataResourceGroup)",
				"StorageAccountName": "$(appname)$(appenvironment)",
				"Location": "",
				"Sku": "Standard_LRS",
				"TableName": ""
			},
			"task": {
				"id": "9d34bd56-d7dc-41d6-ab8f-e8d6329793c3",
				"definitionType": "task",
				"versionSpec": "1.*"
			},
			"timeoutInMinutes": 0,
			"environment": {}
		},
		{
			"alwaysRun": false,
			"condition": "succeeded()",
			"continueOnError": false,
			"displayName": "Store storage account connection string in Key Vault",
			"enabled": true,
			"inputs": {
				"ConnectedServiceName": "$(Azure_Subcription)",
				"ResourceGroupName": "$(Azure_DataResourceGroup)",
				"StorageAccountName": "$(appname)$(appenvironment)",
				"KeyVaultResourceGroupName": "$(Azure_DataResourceGroup)",
				"KeyVaultName": "kvmx-$(appname)-$(appenvironment)",
				"KeyVaultKeyName": "$(appenvironment)-storageaccount",
				"Location": ""
			},
			"task": {
				"id": "fdc8b8d4-78d6-4330-9299-3385f706a758",
				"definitionType": "task",
				"versionSpec": "1.*"
			},
			"timeoutInMinutes": 0,
			"environment": {}
		}
	],
	"version": {
		"isTest": false,
		"major": 1,
		"minor": 0,
		"patch": 0
	}
}